//>>built
define("epi-cms/contentediting/FloatingComponentHandler",["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/dom-style","dijit/Destroyable","epi/obsolete"],function(_1,_2,_3,_4,_5,_6){return _1([_5],{constructor:function(){_6("epi-cms/contentediting/FloatingComponentHandler",null,"12.0");},setComponentPosition:function(_7,_8){if(!this._isValidComponentInfo(_7)||!this._isValidScrollInfo(_8)){return;}var _9=this._getComponentScrollConditions(_7,_8);this._floatComponentFromTop(_7,_7.componentSize.height);_9.floatFromLeft?this._floatComponentFromLeft(_7.component,0):this._floatComponentFromRight(_7.component,0);_9.floatHorizontalInside&&this._floatComponentHorizontalInside(_7,_8,_9);if(_9.floatVerticalInside){this._floatComponentVerticalInside(_7,_8,_9);return;}_9.floatFromBottom&&this._floatComponentFromBottom(_7,_7.componentSize.height);},destroy:function(){this._clearTogglePositionTimeout();this.inherited(arguments);},_isValidComponentInfo:function(_a){if(!_a){return false;}if(!_a.component){return false;}if(!_a.componentSize||!_a.componentSize.width||!_a.componentSize.height){return false;}if(!_a.relativeContainer){return false;}if(!_a.refContainer){return false;}return true;},_isValidScrollInfo:function(_b){if(!_b){return false;}if(!_b.viewportScrollInfo){return false;}if(!_b.overlayItemScrollInfo){return false;}return true;},_getComponentScrollConditions:function(_c,_d){var _e=_d.viewportScrollInfo,_f=_d.overlayItemScrollInfo,_10=_f.horizontal-_e.horizontal,_11=_e.bottom-_f.bottom,_12=_e.right-_f.vertical,_13=_f.left+_f.width,_14=this._hasHorizontalScroll(_e),_15=_e.scrollLeft<_f.left,_16=(_f.width+_f.left-_e.scrollLeft)>_c.componentSize.width,_17=_12>_c.componentSize.width||_12>=_13,_18=_10<_c.componentSize.height,_19=_14&&(_c.componentSize.width<_f.width),_1a=(_c.componentSize.height>_10)&&(_c.componentSize.height>_11);return {horizontalScrolled:_14,keepPositionFromLeft:_15,insideContainerWidth:_16,floatFromLeft:_17,floatFromBottom:_18,floatHorizontalInside:_19,floatVerticalInside:_1a};},_refreshComponentVerticalPosition:function(_1b,_1c){var _1d=_1c.viewportScrollInfo;this._floatComponentVertical(_1b,_1c.overlayItemScrollInfo.top);_1d.refreshPosition&&this._toggleRelativeContainerPosition(_1b,_1d.refreshDelayTime);},_floatComponentHorizontalInside:function(_1e,_1f,_20){var _21=_1f.viewportScrollInfo,_22=_1f.overlayItemScrollInfo,_23=_20.keepPositionFromLeft,_24=_20.insideContainerWidth;if(_23){return;}if(_24){this._floatComponentFromLeft(_1e.component,_21.scrollLeft-_22.left,true);return;}this._floatComponentFromRight(_1e.component,0);},_floatComponentVerticalInside:function(_25,_26,_27){var _28=_26.viewportScrollInfo,_29=_26.overlayItemScrollInfo,_2a=_27.floatFromLeft,_2b=_27.horizontalScrolled,_2c=_27.keepPositionFromLeft,_2d=_27.insideContainerWidth,_2e=_25.componentSize.width>_29.width;if(!_2a){var _2f=_27.horizontalScrolled?(_28.scrollLeft-_29.width):_29.width;this._floatComponentFromRight(_25.component,_2f,_27.horizontalScrolled);this._refreshComponentVerticalPosition(_25,_26);return;}if(!_2b){this._refreshComponentVerticalPosition(_25,_26);return;}if(_2e){this._floatComponentFromLeft(_25.component,_28.scrollLeft);this._refreshComponentVerticalPosition(_25,_26);return;}var _30=_2c?_28.scrollLeft:(_2d?_29.left:(_25.componentSize.width+_28.scrollLeft-_29.width));this._floatComponentFromLeft(_25.component,_30);this._refreshComponentVerticalPosition(_25,_26);},_floatComponentVertical:function(_31,_32){_4.set(_31.component,{top:this._getPositionString(_32)});_4.set(_31.relativeContainer,{position:"fixed"});},_floatComponentFromTop:function(_33,_34,_35){this._changeComponentContainerPlace(_33,"first");_4.set(_33.component,{bottom:"auto",left:"auto",right:"auto",top:this._getPositionString(_34,_35)});},_floatComponentFromLeft:function(_36,_37,_38){_4.set(_36,{left:this._getPositionString(_37,_38),right:"auto"});},_floatComponentFromBottom:function(_39,_3a,_3b){this._changeComponentContainerPlace(_39,"last");_4.set(_39.component,{bottom:this._getPositionString(_3a,_3b),top:"auto"});},_floatComponentFromRight:function(_3c,_3d,_3e){_4.set(_3c,{left:"auto",right:this._getPositionString(_3d,_3e)});},_changeComponentContainerPlace:function(_3f,_40){_3.place(_3f.relativeContainer,_3f.refContainer,_40);_4.set(_3f.relativeContainer,{position:"relative"});},_toggleRelativeContainerPosition:function(_41,_42){this._clearTogglePositionTimeout();var _43=_41.component,_44=_41.relativeContainer,_45=_4.get(_41.relativeContainer,"position"),_46=function(){_4.set(_44,{position:_45});_4.set(_43,{display:"block"});};_4.set(_44,{position:"relative"});_4.set(_43,{display:"none"});_42!=null?(this._togglePositionTimeout=setTimeout(_46,_42)):_46();},_clearTogglePositionTimeout:function(){if(this._togglePositionTimeout){clearTimeout(this._togglePositionTimeout);this._togglePositionTimeout=null;}},_hasHorizontalScroll:function(_47){return _47&&_47.scrollLeft!=null&&_47.scrollLeft>0;},_getPositionString:function(_48,_49){return _48===0?0:((_49===true?"":"-")+_48+"px");}});});