//>>built
define("epi-cms/contentediting/RichTextInlineEditorWrapper",["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","dojo/on","epi/obsolete","epi-cms/contentediting/_FloatingComponentEditorWrapperMixin","epi-cms/contentediting/InlineEditorWrapper"],function(_1,_2,_3,on,_4,_5,_6){return _1([_6,_5],{isUndoDisabled:true,postCreate:function(){this.inherited(arguments);_4("epi-cms/contentediting/RichTextInlineEditorWrapper",null,"12.0");this.own(on(this.get("iframeWithOverlay").iframe,"unload",_2.hitch(this,function(){this.tryToStopEditing();this._blockDisplayNodeOpacity=this.blockDisplayNode=this.overlayItem=null;})));},setupFloatingComponentEditorWrapper:function(_7){this.inherited(arguments);this._setupFloatingEvents(_7);},focus:function(){this.inherited(arguments);this.blockDisplayNode&&_3.set(this.blockDisplayNode,{visibility:"hidden"});this._toggleOverlayItemZIndex(true);this._toggleSupportCustomDnd(true);},startEdit:function(){_2.mixin(this.editorParams,{ready:this.get("overlayItem")!=null});this.inherited(arguments);this.setupFloatingComponentEditorWrapper(this._getComponentFloaterInfo());},tryToStopEditing:function(){this.inherited(arguments);var _8=this.getEditorWidget();if(_8&&_8.tryToStopEditing){_8.tryToStopEditing();}},_onEditorResizing:function(_9){this.blockDisplayNode&&_3.set(this.blockDisplayNode,_9.style);},_onEditorResized:function(_a){var _b=this.get("overlayItem");_b&&_b.onResize();_a&&(this._deferEditorResizedCallback=this.defer(_a,100));},_removeEditingFeatures:function(){this.inherited(arguments);this.blockDisplayNode&&_3.set(this.blockDisplayNode,{height:"auto",visibility:"visible"});this._toggleOverlayItemZIndex();this._toggleSupportCustomDnd();},_setupFloatingEvents:function(_c){var _d=this.get("iframeWithOverlay"),_e=_2.hitch(this,function(_f){var _10=this.getEditorWidget();if(!_10||!_10.isEditing()){return;}_2.mixin(_c,{floatingInfo:{delayTime:_f!=null&&_f.type==="viewportresized"?100:null,refreshPosition:_f!=null&&(_f.type==="viewportresized"||_f.type==="viewportpulldown"),refreshDelayTime:_f!=null&&_f.type==="viewportpulldown"?0:100}});this.onComponentFloat(_c);});this.own(on(_d.previewContainer,"scroll",_e),on(_d.scroller,"scroll",_e),on(_d.domNode,"viewportresized, viewportpulldown",_e));},_getComponentFloaterInfo:function(){var _11=this.get("iframeWithOverlay"),_12=this.get("overlayItem");return {componentInfo:{component:this.getEditorWidget(),componentOverlayItem:_12?_12.item:null,viewport:_11.previewContainer,viewportIframe:_11.iframe.domNode,viewportScroller:_11.scroller}};}});});