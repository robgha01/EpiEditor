//>>built
define("epi-cms/contentediting/viewmodel/LanguageSettingsModel",["dojo/_base/declare","dojo/_base/lang","dojo/topic","dojo/Stateful","dojo/when","dojo/Deferred","epi/dependency","epi-cms/component/SiteTreeModel"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){return _1([_4],{enabled:false,documentLanguage:"",selectedLanguage:"",availableLanguages:[],profile:null,siteTreeModel:null,postscript:function(){this.inherited(arguments);if(!this.siteTreeModel){var _a=_7.resolve("epi.storeregistry"),_b=_a.get("epi.cms.sitestructure");this.siteTreeModel=new _8({store:_b});}this.profile=this.profile||_7.resolve("epi.shell.Profile");this.siteTreeModel.getCurrentSite().then(_2.hitch(this,"_setAvailableLanguages")).then(_2.hitch(this,function(){_5(this.profile.getContentLanguage(),_2.hitch(this,function(_c){this.set("documentLanguage",_c);this.set("selectedLanguage",_c,false);}));}));},_setAvailableLanguages:function(_d){if(_d){var _e=new _6();this.siteTreeModel.getChildren({url:_d.currentSite},_2.hitch(this,function(_f){var obj=_f.filter(function(_10){return (_10.languageId&&_10.name);}).map(function(_11){return {label:_11.name,value:_11.languageId};});this.set("availableLanguages",obj);_e.resolve();}));return _e.promise;}else{return new _6().resolve();}},_enabledSetter:function(_12){if(this.enabled!==_12){this.enabled=_12;_3.publish("/epi/cms/action/eyetoggle",_12);}},_selectedLanguageSetter:function(_13,_14){if(_14!==false){_3.publish("/epi/cms/action/viewsettingvaluechanged","viewlanguage",_13);}}});});