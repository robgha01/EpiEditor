//>>built
define("epi-cms/contentediting/editors/_ContentAreaTree",["dojo/_base/declare","dojo/aspect","dojo/_base/event","dojo/_base/array","dojo/_base/lang","dojo/dom-class","dijit/registry","epi/dependency","epi/shell/conversion/ObjectConverterRegistry","epi/shell/dnd/tree/dndSource","epi/shell/TypeDescriptorManager","epi/shell/widget/Tree","epi-cms/contentediting/viewmodel/ContentBlockViewModel","epi-cms/contentediting/viewmodel/PersonalizedGroupViewModel","./_BlockTreeNode","./_GroupTreeNode"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){return _1([_c],{persist:false,showRoot:false,dndController:_a,betweenThreshold:8,_typeDescriptorManager:null,postMixInProperties:function(){this.inherited(arguments);this._typeDescriptorManager=this._typeDescriptorManager||_b;this.accept.push("personalizationarea");},postCreate:function(){this.inherited(arguments);_6.add(this.domNode,"epi-tree-mngr");this.own(_2.after(this.dndController,"onDndItemRemoved",_5.hitch(this,function(_11){if(_11[0]&&_11[0].data){this.model.deleteItem(_11[0].data);}}),true));this.own(_2.after(this,"_onItemChildrenChange",_5.hitch(this,function(_12,_13){_4.forEach(_13,function(_14){var _15=this._itemNodesMap[this.model.getIdentity(_14)];if(_14.expandOnAdd){this._expandNode(_15[0]);}if(_14.contentGroup&&_14.ensurePersonalization&&_14.hasAnyRoles&&!_14.hasAnyRoles()){_15[0].showPersonalizationSelector();}},this);}),true));},getTooltip:function(_16){return _16.tooltip||_16.label||"";},_setReadOnlyAttr:function(_17){this._set("readOnly",_17);if(this.dndController){this.dndController.isSource=!_17;}},getItemType:function(_18){if(_18.typeIdentifier){var _19=this._typeDescriptorManager.getAndConcatenateValues(_18.typeIdentifier,"dndTypes");return _19;}else{if(_18.contentGroup!==undefined){return ["personalizationarea"];}}return this.accept;},checkItemAcceptance:function(_1a,_1b,_1c,_1d){if(this.tree.readOnly){return false;}var _1e=_7.getEnclosingWidget(_1a);var _1f=_1e.item;var _20=true;_1b.forInSelectedItems(function(_21){_20=this.tree.model.checkItemAcceptance(_1f,_21.data.item,_1c);},this);return _20;},_onNodeMouseEnter:function(_22){_22.set("mouseHover",true);},_onNodeMouseLeave:function(_23){_23.set("mouseHover",false);},_createTreeNode:function(_24){var _25;if(_24.item instanceof _e){_25=new _10(_24);}else{if(_24.item instanceof _d){_25=new _f(_24);}else{_25=this.inherited(arguments);}}_25.set("contextMenu",this.contextMenu);_25.set("dndData",_24.item);return _25;},onClick:function(_26,_27,e){if(_27 instanceof _10){if(_27.isExpanded){this._collapseNode(_27);}else{this._expandNode(_27);}}}});});