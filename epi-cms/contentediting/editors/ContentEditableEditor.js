//>>built
define("epi-cms/contentediting/editors/ContentEditableEditor",["dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dojo/dom-class","dojo/dom-style","dojo/on","dojo/query","dijit/_FocusMixin","dijit/_WidgetBase","dijit/focus","dijit/Tooltip","epi/string","epi/shell/widget/_ValueRequiredMixin","epi-cms/contentediting/editors/_ClipboardPasteMixin"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9,_a,_b,_c,_d){return _1([_8,_7,_c,_d],{baseClass:"epi-content-editable-editor",uiSafeHtmlTags:[],blockDisplayNode:null,postCreate:function(){this.inherited(arguments);var _e=this.blockDisplayNode;this.pasteMixinSetup(this.id,_e);this.own(on(this.domNode,"click",_2.hitch(this,function(e){this.get("state")==="Error"&&this._makeContentEditable();})),on(_e,"blur",_2.hitch(this,this.validate)),on(_e,"keydown",_2.hitch(this,this.validate)));},destroy:function(){this.blockDisplayNode=null;this.inherited(arguments);},focus:function(){this._makeContentEditable();this.inherited(arguments);},isValid:function(_f){var _10=this.get("value");if(this.required&&_b.isNullOrEmpty(_10)){return false;}if(this.pattern&&!(new RegExp(this.pattern).test(_10))){return false;}return true;},getErrorMessage:function(_11){return (this.required&&_b.isNullOrEmpty(this.get("value")))?this.missingMessage:this.invalidMessage;},validate:function(_12){this.focused=_12;var _13=this.inherited(arguments);this.set("message",this.getErrorMessage());return _13;},_makeContentEditable:function(){var _14=this.blockDisplayNode;_3.set(_14,"contenteditable","true");_5.set(this.domNode,"width","auto");_9.focus(_14);this.get("state")!=="Error"&&this._setCaretPosition(_14,_14.textContent.length);},_setCaretPosition:function(_15,_16){var _17=_15.ownerDocument,_18=_17.createRange(),_19=_17.getSelection();if(!_15.lastChild){_15.appendChild(_17.createTextNode(""));}_16=Math.min(_15.lastChild.textContent.length,_16);_18.setStart(_15.lastChild,_16);_18.collapse(true);_19.removeAllRanges();_19.addRange(_18);},_getValueAttr:function(){return _2.trim(_6(this.blockDisplayNode).text());},_setValueAttr:function(val){_6(this.blockDisplayNode).text(val||"");},_removeEditingFeatures:function(){_3.remove(this.blockDisplayNode,"contenteditable");}});});