//>>built
define("epi-cms/contentediting/editors/_ClipboardPasteMixin",["dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/_base/lang","dojo/_base/window","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/on","dojo/query","dijit/Destroyable","epi/string"],function(_1,_2,_3,_4,_5,_6,_7,_8,on,_9,_a,_b){return _2(_a,{_editingKey:"",_editingNode:null,_editingContainer:null,_beginEditingPoint:null,_endEditingPoint:null,_pasteEventActive:false,_beginEditingPointCSSClass:"epi-content-editable-begin-edit",_endEditingPointCSSClass:"epi-content-editable-end-edit",canAccessClipboard:function(_c){return !!this.getClipboard(_c);},getClipboard:function(_d){return (_d&&_d.clipboardData)||_5.global.clipboardData;},getClipboardData:function(_e){var _f=this.getClipboard(_e);return (_f&&_5.global.clipboardData)?_f.getData("Text"):_f.getData("text/plain");},destroy:function(){this.inherited(arguments);this._destroyRedundantNodes([this._beginEditingPoint||this._getEditingPoint("before"),this._endEditingPoint||this._getEditingPoint("after")]);this._editingNode=this._editingContainer=this._beginEditingPoint=this._endEditingPoint=null;},pasteMixinSetup:function(_10,_11){if(!_11){return;}this._editingKey=_10;this._editingNode=_11;this._editingContainer=this._editingNode.parentNode;this.own(on(this._editingNode,"beforepaste",_4.hitch(this,this._onBeforePaste)),on(this._editingNode,"paste",_4.hitch(this,this._onPaste)),on(this._editingNode,"input",_4.hitch(this,this._onInput)));},_onBeforePaste:function(evt){if(this.canAccessClipboard(evt)&&_5.global.clipboardData){this.getClipboard(evt).setData("Text",_b.stripHtmlTags(this.getClipboardData(evt)));}},_onPaste:function(evt){if(_5.global.clipboardData){return;}if(this.canAccessClipboard(evt)){this._processNativePaste(evt);_3.stop(evt);return;}},_onInput:function(evt){if(this.canAccessClipboard(evt)||!this._pasteEventActive){return;}this._processManualPaste();},_processNativePaste:function(evt){var _12=this._editingNode.ownerDocument,_13=_b.stripHtmlTags(this.getClipboardData(evt));if(!_b.isNullOrEmpty(_13)){_12.execCommand("insertText",false,_13);}},_getEditingPoint:function(_14){return _9("span."+this._getEditingPointClass(_14),this._editingContainer)[0];},_getEditingPointClass:function(_15){var _16=(_15==="before"?this._beginEditingPointCSSClass:this._endEditingPointCSSClass);if(!_b.isNullOrEmpty(this._editingKey)){_16+="-"+this._editingKey;}return _16;},_createEditingPoint:function(_17){var _18=_8.create("span",{"class":this._getEditingPointClass(_17),style:"display:none;position:absolute;left:-99em;"},this._editingNode,_17==="before"?"before":"after");return _18;},_destroyRedundantNodes:function(_19){if(_19 instanceof Array&&_19.length>0){_19.forEach(_8.destroy);}}});});