//>>built
define("epi-cms/contentediting/command/ManageExpiration",["dojo/_base/connect","dojo/_base/declare","dojo/when","epi-cms/contentediting/ExpirationDialog","epi-cms/contentediting/viewmodel/ExpirationDialogViewModel","epi-cms/contentediting/ContentActionSupport","epi/shell/command/_Command","epi/shell/DialogService","epi/i18n!epi/cms/nls/episerver.cms.widget.expirationeditor","epi/i18n!epi/nls/episerver.shared"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){return _2([_7],{label:_9.dialogtitle,tooltip:_9.dialogtitle,viewModel:null,cssClass:"epi-chromelessButton epi-visibleLink",expirationDialogClass:_4,expirationDialogViewModelClass:_5,_execute:function(){var _b=this.get("viewModel");var _c=new this.expirationDialogClass({model:_b});_8.dialog({defaultActionsVisible:false,confirmActionText:_a.action.save,content:_c,title:_9.dialogtitle}).then(function(_d){var _e=this.get("model");_e.saveAndPublishProperty("iversionable_expire",_d,_6.saveAction.SkipValidation);}.bind(this));},_onModelChange:function(){var _f=this.get("model");if(!_f||!_f.contentData){this.set("canExecute",false);return;}var _10=_f.contentData.properties,_11=_10.iversionable_expire;var _12=_f.canChangeContent()&&_6.hasAccess(_f.contentData.accessMask,_6.accessLevel.Publish);this.set("canExecute",false);_3(_f.getPropertyMetaData("iversionable_expire")).then(function(_13){this.set("viewModel",new this.expirationDialogViewModelClass({metadata:_13,contentLink:_f.contentLink,contentName:_f.contentData.name,value:_11,minimumExpireDate:_10.iversionable_startpublish}));this.set("canExecute",_12);}.bind(this),function(res){if(res&&res.status===409){_8.alert(_a.messages.unexpectederror);}});}});});