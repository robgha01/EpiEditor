//>>built
require({cache:{"url:epi-cms/widget/templates/Trash.html":"<div class=\"epi-trash\">\r\n    <div class=\"epi-listingTopContainer\">\r\n        <h1 class=\"dijitInline\">${resources.heading}</h1>\r\n        <div class=\"epi-mediumButton epi-button--bold epi-emptyCommand\" data-dojo-attach-point=\"emptyTrashMenu\" data-dojo-type=\"epi-cms/widget/EmptyTrashMenu\"\r\n            data-dojo-props=\"title: '${resources.emptytrash.tooltip}'\"></div>\r\n    </div>\r\n    <div data-dojo-attach-point=\"stackContainer\">\r\n        <div data-dojo-type=\"dijit/layout/TabContainer\" data-dojo-attach-point=\"tabContainer\" data-dojo-props=\"doLayout:false, useMenu:true, useSlider:false\"> <!-- doLayout=\"false\" for flexible height -->\r\n        </div>\r\n    </div>\r\n</div>\r\n"}});define("epi-cms/widget/Trash",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-construct","dojo/Evented","dojo/_base/Deferred","dojox/html/entities","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/layout/TabContainer","dijit/layout/ContentPane","dijit/registry","epi/shell/widget/_ModelBindingMixin","epi/shell/DialogService","epi/shell/command/withConfirmation","epi-cms/widget/TrashItemList","epi-cms/widget/EmptyTrashMenu","epi-cms/widget/TrashViewModelConfirmation","epi-cms/widget/command/EmptyTrash","epi-cms/widget/command/RestoreContent","epi-cms/widget/command/DeleteContent","epi/i18n!epi/cms/nls/episerver.cms.components.trash","dojo/text!./templates/Trash.html"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19){return _2([_9,_a,_b,_f,_6],{resources:_18,templateString:_19,_restoreContentCommand:null,typeIdentifiers:null,modelBindingMap:{contentStore:["store"],queryOptions:["queryOptions"],actionResponse:["actionResponse"],trashes:["trashes"]},postCreate:function(){this.inherited(arguments);this.tabContainer.watch("selectedChildWidget",_3.hitch(this,function(_1a,_1b,_1c){this.model.set("currentTrash",_1c.trash);}));this._restoreContentCommand=new _16({model:this.model});this.watch("model",_3.hitch(this,function(){this.model=_14(this.model);this._restoreContentCommand.set("model",this.model);}));this.on("restoreItem",this._onRestoreItemClick);this.on("deleteItem",this._onDeleteItemClick);},_setTrashesAttr:function(_1d){this.tabContainer.destroyDescendants();var _1e=[];_1.forEach(_1d,function(_1f){if(_1f&&_1f.active){this._addTrash(_1f);var _20=new _15({hasDeleteAccess:_1f.hasDeleteAccess,label:_1f.name,tooltip:_1f.name,trashId:_1f.wasteBasketLink,model:this.model});_1e.push(_11(_20,null,{title:_18.emptytrash.title,description:this.model.getEmptyTrashConfirmMessage(_1f.name),onShow:_3.hitch(this,function(){var _21=this.tabContainer.selectedChildWidget.getChildren()[0];_21.clearSelection();})}));}},this);this.emptyTrashMenu.set("commands",_1e);if(_1d&&_1d.length===1){_4.add(this.tabContainer.domNode,"hide-tablist");}this.tabContainer.startup();this.tabContainer.layout();},_addTrash:function(_22){var _23=null;if(_22.active){_22.isRequireLoad=true;var _24=new _d({title:_22.name,trash:_22});this.tabContainer.addChild(_24);if(this._isSelected(_22)){_23=_24;}}if(_23){this.tabContainer.selectChild(_23);}},_isSelected:function(_25){var _26=false;_1.some(_25.typeIdentifiers,_3.hitch(this,function(_27){return _1.some(this.typeIdentifiers,function(_28){if(_27===_28){_26=true;return false;}});}));return _26;},_setQueryOptionsAttr:function(_29){if(_29){var _2a=this.tabContainer.selectedChildWidget;if(_2a){var _2b=this.get("store"),_2c=null;if(_2a.itemListId){_2c=_e.byId(_2a.itemListId);_2c.set("queryOptions",_29);}else{_2c=new _12({queryOptions:_29,store:_2b,model:this.model});_2c.on("restoreItem",_3.hitch(this,function(row){this.emit("restoreItem",row);}));_2c.on("deleteItem",_3.hitch(this,function(row){this.emit("deleteItem",row);}));_2c.on("searchBoxChange",_3.hitch(this,this._onSearchBoxChange));_2a.set("content",_2c);_2a.itemListId=_2c.id;}}}},_setActionResponseAttr:function(_2d){if(!_2d){return;}this._showNotificationMessage(_2d);},_showNotificationMessage:function(_2e){if(_2e instanceof Array){_10.alertWithErrors({},_2e);}else{_10.alert(_2e?_2e:"");}},_onRestoreItemClick:function(row){if(row&&row.data&&this.model.get("currentTrash")){this._restoreContentCommand.set("content",row.data);this._restoreContentCommand.execute();}},_onDeleteItemClick:function(row){if(row&&row.data&&this.model.get("currentTrash")){var _2f=_11(new _17({model:this.model,contentId:row.data.contentLink}),null,{title:_18.singledelete.dialog.title,description:_3.replace(_18.singledelete.dialog.description,[_8.encode(row.data.name)])});_2f._execute();}},_onSearchBoxChange:function(_30){var _31=this.model.get("currentTrash");_31.queryText=_30;_31.isRequireLoad=true;this.model.set("currentTrash",_31);}});});