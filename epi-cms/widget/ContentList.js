//>>built
define("epi-cms/widget/ContentList",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/dom-class","dojo/dom-construct","dojo/aspect","dojo/Evented","dojo/keys","dojo/on","dgrid/Keyboard","dgrid/OnDemandList","dgrid/Selection","dojox/html/entities","epi/epi","epi/shell/dgrid/Formatter","epi/shell/dgrid/selection/Extensions","epi/shell/TypeDescriptorManager","epi/shell/widget/_FocusableMixin","epi-cms/core/ContentReference","epi-cms/dgrid/formatters","epi-cms/dgrid/DnD","epi-cms/dgrid/WithContextMenu","epi-cms/widget/ReadOnlyContentList"],function(_1,_2,_3,_4,_5,_6,_7,_8,on,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,DnD,_14,_15){return _1([_15,_11,_7],{_gridClass:_1([_a,_e,_b,_f,DnD,_9,_14]),resources:"",noDataMessage:null,editingItem:null,postCreate:function(){this.inherited(arguments);_4.add(this.domNode,"epi-contentList");},_setCurrentItemAttr:function(_16){if(!this.get("editingItem")){this.set("editingItem",_16);}this._set("currentItem",_16);this.select(_16);},_setNoDataMessageAttr:function(_17){this.noDataMessage=_17;this.grid.set("noDataMessage",_17);},_dndNodeCreator:function(_18,_19){var _1a=_10.getAndConcatenateValues(_18.typeIdentifier,"dndTypes");if(!_1a&&this.dndTypes){_1a=this.dndTypes;}return {node:_5.create("div").appendChild(document.createTextNode(_18.name)),type:_1a,data:_18};},getListSettings:function(){var _1b={hasMenu:!!this.contextMenu,settings:{title:_d.resources.action.options}};return _3.delegate(this._getBaseSettings(_1b),{noDataMessage:this.noDataMessage,dndParams:{copyOnly:true,selfAccept:false,accept:[],creator:_3.hitch(this,this._dndNodeCreator)}});},setupEvents:function(){this.inherited(arguments);this.own(_6.around(this.grid,"insertRow",_3.hitch(this,this._aroundInsertRow)),this.grid.on("dgrid-contextmenu",_3.hitch(this,"_itemSelected")));this._bindKeys();},_bindKeys:function(){var _1c=this;function _1d(key,_1e,_1f,_20){return _1c.grid.addKeyHandler(key,function(e){if(_20||_2.isCopyKey(e)){e.preventDefault();_1f?_1c.emit(_1e,_1f):_1c.emit(_1e);}});};this.own(_1d("C".charCodeAt(0),"copyOrCut",true),_1d("X".charCodeAt(0),"copyOrCut",false),_1d("V".charCodeAt(0),"paste"),_1d(_8.DELETE,"delete",undefined,true));},_onSelect:function(evt){this.inherited(arguments);if(this.grid.selectionMode==="single"&&evt.rows[0].data){this._itemSelected(evt.rows[0].element);}},_itemSelected:function(_21){var row=this.grid.row(_21);this.emit("itemSelected",row.data);},editContent:function(_22){if(!_22||!this.grid.row(_22).element){return;}this.emit("itemAction",_22);this.set("editingItem",this.currentItem);},editSelectedContent:function(){var _23=this.grid.getFirstSelectedRow();if(!_23){return;}this.editContent(_23.data);},_onChangeContext:function(evt){var _24=this.grid;on.once(_24.domNode,"dgrid-refresh-complete",function(evt){_24.focus(_24.getFirstSelectedRow());});this.editContent(_24.row(evt).data);},toggleCut:function(_25,_26){var row;if(_25){row=this.grid.row(_12.toContentReference(_25.contentLink).id);if(row&&row.element){_4.toggle(row.element,"epi-opacity50",_26);}}}});});