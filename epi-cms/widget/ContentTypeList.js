//>>built
define("epi-cms/widget/ContentTypeList",["dojo/_base/declare","dojo/dom-class","dojo/promise/all","dojo/when","dijit/layout/_LayoutWidget","epi/shell/TypeDescriptorManager","epi-cms/widget/ContentTypeGroup","epi-cms/widget/viewmodel/ContentTypeListViewModel","epi/i18n!epi/cms/nls/episerver.cms.widget.contenttypelist"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){return _1([_5],{parentLink:null,requestedType:null,shouldSkipContentTypeSelection:null,allowedTypes:null,restrictedTypes:null,postMixInProperties:function(){this.inherited(arguments);this.model=new _8();this.own(this.model);},buildRendering:function(){this.inherited(arguments);var _a=new _7();this.connect(_a,"onSelect",function(_b){this.onContentTypeSelected(_b);});this.addChild(_a);this._suggestedContentTypes=_a;},refresh:function(){this.clear();this._setupWidgetTemplate();_4(_3({types:this.model.getSortedSuggestedContentTypes(),groups:this.model.getSortedGroupContentTypes()})).then(function(_c){var _d=_c.types,_e=_c.groups,_f=_e.grouped,_10=_e.contentTypes;if(_d.length<=0){this._suggestedContentTypes.setVisibility(false);}else{_2.add(this._suggestedContentTypes.titleNode,"epi-ribbonHeaderSpecial");this._suggestedContentTypes.set("title",this._suggestedTypesTitle);this._suggestedContentTypes.set("contentTypes",_d);this._suggestedContentTypes.setVisibility(true);}var key,_11;for(key in _f){_11=this._getOrCreateGroup(key);_11.set("contentTypes",_f[key]);}if(_10 instanceof Array&&_10.length===1){this.setVisibility(false);this.set("shouldSkipContentTypeSelection",true);this.onContentTypeSelected(_10[0]);}else{this.set("shouldSkipContentTypeSelection",false);}}.bind(this));},setVisibility:function(_12){this.getChildren().forEach(function(_13){_13.setVisibility(_12);},this);},_setupWidgetTemplate:function(){this._suggestedTypesTitle=_6.getResourceValue(this.requestedType,"suggestedtypes");this.model.otherTypesTitle=_6.getResourceValue(this.requestedType,"othertypes");},clear:function(){this._suggestedContentTypes.clear();this.model.clear();},_getOrCreateGroup:function(_14){var _15=this.model.groups[_14];if(!_15){_15=new _7({title:_14});this.connect(_15,"onSelect",function(_16){this.onContentTypeSelected(_16);});this.addChild(_15);this.model.groups[_14]=_15;}return _15;},_setLocalAssetAttr:function(_17){this._set("localAsset",_17);this.model.set("localAsset",_17);if(this.requestedType&&this.parentLink){this.refresh();}},_setParentLinkAttr:function(_18){this._set("parentLink",_18);this.model.set("parentLink",_18);if(this.requestedType){this.refresh();}},_setRequestedTypeAttr:function(_19){this._set("requestedType",_19);this.model.set("requestedType",_19);},_setAllowedTypesAttr:function(_1a){this._set("allowedTypes",_1a);this.model.set("allowedTypes",_1a);},_setRestrictedTypesAttr:function(_1b){this._set("restrictedTypes",_1b);this.model.set("restrictedTypes",_1b);},onContentTypeSelected:function(){}});});