//>>built
define("epi-cms/widget/viewmodel/ContentStatusViewModel",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/when","dojo/promise/all","dojo/Stateful","epi/dependency","epi-cms/contentediting/ContentActionSupport","epi/shell/_ContextMixin","epi-cms/ContentLanguageHelper","epi/i18n!epi/cms/nls/episerver.cms.contentediting.versionstatus"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){return _2([_7,_a],{_contentStructureStore:null,autoLoadStatus:false,statusIcon:null,statusMessage:null,contentLink:null,constructor:function(){this._statusIconMap={0:["epi-statusIndicatorIcon","epi-statusIndicator0"],1:["epi-statusIndicatorIcon","epi-statusIndicator1"],2:["epi-statusIndicatorIcon","epi-statusIndicator2"],3:["epi-statusIndicatorIcon","epi-statusIndicator3"],4:["epi-statusIndicatorIcon","epi-statusIndicator4"],5:["epi-statusIndicatorIcon","epi-statusIndicator5"],6:["epi-statusIndicatorIcon","epi-statusIndicator6"],7:["epi-statusIndicatorIcon","epi-statusIndicator7"],100:["epi-statusIndicatorIcon","epi-statusIndicator100"]};this._statusMessageMap={0:_c.notcreated,1:_c.rejected,2:_c.checkedout,3:_c.checkedin,4:_c.published,5:_c.previouslypublished,6:_c.delayedpublish,7:_c.awaitingapproval,100:_c.expired};},postscript:function(){this.inherited(arguments);this._contentStructureStore=this._contentStructureStore||_8.resolve("epi.storeregistry").get("epi.cms.content.light");},loadStatus:function(){if(!this.contentLink){return;}_5(this.getCurrentContext(),_4.hitch(this,function(_d){_5(this._contentStructureStore.refresh(this.contentLink),_4.hitch(this,function(_e){if(_e&&_e.status!==undefined){this.set("content",_e);}}));}));},_contentLinkSetter:function(_f){if(!_f){return;}this.contentLink=_f;if(this.autoLoadStatus){this.loadStatus();}},_isDeletedGetter:function(){return this.get("content")&&this.get("content").isDeleted;},_isTranslationNeededGetter:function(){return this.get("content")&&this.get("content").missingLanguageBranch&&this.get("content").missingLanguageBranch.isTranslationNeeded;},_missingLanguageBranchGetter:function(){return this.get("content")&&this.get("content").missingLanguageBranch;},_contentSetter:function(_10){this.content=_10;this.set("contentStatus",_10.status);},_contentStatusSetter:function(_11){this.contentStatus=_11;if(!_11){return;}this.set("statusIcon",this._statusIconMap[_11]);return _5(this._getStatusMessage(),_4.hitch(this,function(_12){return this.set("statusMessage",_12);}));},_getStatusMessage:function(){if(this.get("isDeleted")){return _c.versionnotfound;}if(this.get("isTranslationNeeded")){return _b.getMissingLanguageMessage(this.content);}if(this.get("isVisibleOnSite")){return null;}return this._statusMessageMap[this.get("contentStatus")];},_isVisibleOnSiteGetter:function(){var _13=this.get("missingLanguageBranch");if(this.get("isDeleted")||_13&&_13.reason===6){return false;}return this.get("contentStatus")===_9.versionStatus.Published;}});});