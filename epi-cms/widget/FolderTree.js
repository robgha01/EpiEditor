//>>built
define("epi-cms/widget/FolderTree",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dojo/dom-class","dojo/aspect","dojo/json","dojo/when","dojox/html/entities","dijit/tree/_dndSelector","epi/dependency","epi/string","epi/shell/widget/_FocusableMixin","epi-cms/widget/_FolderTreeNode","epi-cms/widget/ContentTree","epi-cms/widget/ContentTreeStoreModel"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){return _2([_f,_d],{handleSelection:true,postCreate:function(){var _11=this;_11.inherited(arguments);_11.own(_11.connect(_11.model,"onDeleted",_3.hitch(_11,_11._onDeleted)),_6.around(_11.model,"onRefreshRoots",function(_12){return function(_13){if(_13&&typeof _11._onItemDelete==="function"){_11._onItemDelete(_13);}return _12.apply(_11.model,[_13]);};}));},toggleCut:function(_14,_15){var _16=this.tree.getNodesByItem(_14)[0];if(_16){_5.toggle(_16.rowNode,"epi-opacity50",_15);}},_createTreeModel:function(){return new _10({store:this.store});},_updateItemDeletedHierachy:function(_17){if(!_17){return;}_1.forEach(_17.getChildren(),function(_18){_18.set({item:_3.mixin(_18.item,{isDeleted:true})});this._updateItemDeletedHierachy(_18);},this);},_onDeleted:function(_19){var _1a=this.getNodesByItem(_19);_1.forEach(_1a,function(_1b){this._updateItemDeletedHierachy(_1b);},this);},_renameFolder:function(_1c,_1d){var _1e=_3.trim(_1d),_1f=this.getNodesByItem(_1c)[0];if(_1e){_8(this.model.rename(_1c.contentLink,_1e)).otherwise(function(ex){_1f.rollbackLabel(_1c.name,ex);_1f.edit();});}else{_1f.rollbackLabel(_1c.name);}},buildNodeFromTemplate:function(_20){var _21=new _e(_20);_21.bindContextMenu(this.contextMenu);this.own(_21.on("rename",_3.hitch(this,function(val){this._renameFolder(_21.item,val);})));return _21;},_onNodeMouseEnter:function(_22,evt){this.inherited(arguments);_22._handleMouseEnter();},_onNodeMouseLeave:function(_23,evt){this.inherited(arguments);_23._handleMouseLeave();},_onClick:function(_24,evt){this.inherited(arguments);_24._onClick();},checkAcceptance:function(_25,_26){if(this.tree.supportedDndSources){return this.tree.supportedDndSources.indexOf(_25)>=0;}else{return this.inherited(arguments);}}});});