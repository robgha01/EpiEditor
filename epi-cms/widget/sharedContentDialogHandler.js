//>>built
define("epi-cms/widget/sharedContentDialogHandler",["dojo/_base/lang","dojo/Deferred","dojox/html/entities","epi","epi/shell/TypeDescriptorManager","epi/shell/widget/dialog/Dialog","epi/shell/widget/DelayableStandby","epi-cms/widget/ContentReferences","epi/i18n!epi/cms/nls/episerver.cms.widget.contentreferences"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){var _a=function(_b){var _c=new _2(),_d=_b.contentItems,_e=_d[0],_f=new _7({target:document.body,zIndex:999}).placeAt(document.body);_f.show(50,0);var _10=_b.mode||_a.mode.confirm,_11=_10===_a.mode.confirm,_12=new _8({contentItems:_d,mode:_10});var _13=_12.watch("numberOfReferences",function(_14,_15,_16){_13.remove();var _17=_d.length===1;var _18;var _19=_17?"movetotrashsingleitemdescription":"movetotrashdescription";if(_11){_18=_5.getResourceValue(_e.typeIdentifier,_19);_18=_1.replace(_18,[_17?_3.encode(_e.name):_d.length]);}else{_18=_5.getResourceValue(_e.typeIdentifier,"referencesdescription");_18=_1.replace(_18,[_3.encode(_e.name)]);}var _1a=_b.title;if(!_1a){var _1b=_11?(_17?"movetotrashsingleitem":"movetotrash"):"references";_1a=_5.getResourceValue(_e.typeIdentifier,_1b);}var _1c=new _6({focusActionsOnLoad:true,defaultActionsVisible:_11,dialogClass:"epi-dialog-contentReferences",title:_1a,description:_18,cancelActionText:_4.resources.action.cancel,confirmActionText:_16===0?_9.buttons.movetotrash:_9.buttons.movetotrashanyway,setFocusOnConfirmButton:_16===0});if(!_11){_1c.definitionConsumer.add({name:"close",label:_4.resources.action.close,action:_1c.onCancel});}_1c.connect(_1c,"onExecute",_c.resolve);_1c.connect(_1c,"onCancel",_c.cancel);_1c.set("content",_12);var _1d=_12.on("viewReference",function(){_1c.hide();_1d.remove();});_f.hide();var _1e=_12.grid.on("dgrid-refresh-complete",function(){_1e.remove();_1c.show();}.bind(this));});_12.startup();return _c.promise;};_a.mode={confirm:"confirm",show:"show"};return _a;});