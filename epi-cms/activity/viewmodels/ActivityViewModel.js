//>>built
define("epi-cms/activity/viewmodels/ActivityViewModel",["dojo/_base/declare","dojo/_base/lang","dijit/Destroyable","epi/datetime","epi/username","epi/shell/TypeDescriptorManager","epi-cms/ApplicationSettings","./_ActivityViewModel","epi/i18n!epi/cms/nls/episerver.cms.activities.activity"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){return _1([_8,_3],{id:null,hasMessage:false,title:null,content:null,comment:null,actionIconClass:null,actionClass:null,iconClass:null,_resources:_9,postscript:function(){this.inherited(arguments);this.set({id:this.activity.id,hasMessage:!!this.activity.message,upsertActivityComment:null,comment:this.activity.comment,title:this.activity.name});this.own(this.activityService.on("activity-comment-updated",_2.hitch(this,this._activityCommentUpdated)));this.set("actionIconClass",_2.replace("epi-icon{actionIcon} epi-icon--{actionColor}",this.activity));this.set("actionClass",_2.replace("epi-event--{actionColor} epi-event--{actionColor}-{activityType}",this.activity));this.set("iconClass",_6.getValue(this.activity.typeIdentifier,"iconClass")||"epi-iconProject");var _a=this.activity;var _b=_a.delayPublishUntil?this._resources.delaypublishmessagetemplate:this._resources.messagetemplate;var _c=_2.replace(_b,{event:_a.actionText,delaypublish:_4.toUserFriendlyString(_a.delayPublishUntil),user:_5.toUserFriendlyString(_a.changedBy),date:_4.toUserFriendlyString(_a.created)});this.set("content",_c);},_editLabelGetter:function(){return this.hasMessage?this._resources.message.reply.label:this._resources.message.comment.label;},_save:function(_d){return this.activityService.addComment(this.id,_d);},_activityCommentUpdated:function(_e){if(_e&&_e.activityId===this.id){this.set("upsertActivityComment",_e);}},_titleSetter:function(_f){var _10=this.activity.language;if(_10&&_10!==_7.currentContentLanguage){_f=_2.replace("{0} ({1})",[_f,_10]);}this.title=_f;}});});