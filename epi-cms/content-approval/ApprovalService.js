//>>built
define("epi-cms/content-approval/ApprovalService",["dojo/topic","dojo/when","dojo/Deferred","epi/shell/xhr/errorHandler","epi/dependency"],function(_1,_2,_3,_4,_5){function _6(_7,_8){this.approvalStore=_7||_5.resolve("epi.storeregistry").get("epi.cms.approval");this.approvalDefinitionStore=_8||_5.resolve("epi.storeregistry").get("epi.cms.approval.definition");};_6.prototype.approvalStore=null;_6.prototype.approvalDefinitionStore=null;_6.prototype.getApproval=function(_9){return _2(this.approvalStore.get(_9)).otherwise(function(){return null;});};_6.prototype.approveChanges=function(_a,_b,_c){return _4.wrapXhr(this.approvalStore.executeMethod("ApproveChanges",_a,{activeStepIndex:_b,approveReason:_c}));};_6.prototype.forceCompleteApproval=function(_d,_e){return _4.wrapXhr(this.approvalStore.executeMethod("ForceComplete",_d,{forceReason:_e}));};_6.prototype.rejectChanges=function(_f,_10,_11){return _4.wrapXhr(this.approvalStore.executeMethod("RejectChanges",_f,{activeStepIndex:_10,rejectReason:_11}));};_6.prototype.cancelChanges=function(_12){return _4.wrapXhr(this.approvalStore.executeMethod("CancelChanges",_12.id));};_6.prototype.commentChanges=function(_13,_14){return _4.wrapXhr(this.approvalStore.executeMethod("CommentChanges",_13,{comment:_14}));};_6.prototype.getDefinition=function(_15){return _2(this.approvalDefinitionStore.get(_15)).otherwise(function(){return null;});};_6.prototype.getApprovalRelatedDefinition=function(_16){return _2(this.approvalDefinitionStore.query({id:_16,getApprovalRelatedDefinition:true})).otherwise(function(){return null;});};_6.prototype.navigateToDefinition=function(_17){_1.publish("/epi/shell/context/request",{uri:"epi.cms.approval:///"+_17},{sender:null});};_6.prototype.hasDefinition=function(_18){return this.getDefinition(_18).then(function(_19){return _19!==null&&_19.id!==0;});};_6.prototype.saveDefinition=function(_1a){if(!_1a){return new _3().reject();}return _4.wrapXhr(this.approvalDefinitionStore.put(_1a));};_6.prototype.deleteDefinition=function(_1b){return _4.wrapXhr(this.approvalDefinitionStore.remove(_1b));};_6.prototype.inheritDefinition=function(_1c){return _4.wrapXhr(this.approvalDefinitionStore.executeMethod("Inherit",_1c));};return _6;});