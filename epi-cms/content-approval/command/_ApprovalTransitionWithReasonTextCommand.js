//>>built
define("epi-cms/content-approval/command/_ApprovalTransitionWithReasonTextCommand",["dojo/_base/declare","dojo/Deferred","dojo/dom-construct","epi/shell/widget/ValidationTextarea","./_ApprovalTransitionCommand","epi-cms/contentediting/command/_CommandWithDialogMixin"],function(_1,_2,_3,_4,_5,_6){return _1([_5,_6],{dialogContentClass:_4,dialogClass:"epi-dialog-confirm",executeMethod:null,isCommentRequiredPropertyName:null,dialogPlaceHolder:null,dialogText:null,postscript:function(){this.inherited(arguments);this.dialogContentParams={required:true,intermediateChanges:true,placeHolder:this.dialogPlaceHolder,"class":"epi-textarea--max-height--500"};},_execute:function(){return this._getApprovalDefinition().then(function(_7){if(_7[this.isCommentRequiredPropertyName]){this._executeDeferred=new _2();this.showDialog();return this._executeDeferred.promise;}else{return this._executeServiceMethod();}}.bind(this));},_getApprovalDefinition:function(){return this.approvalService.getApprovalRelatedDefinition(this.model.contentLink);},showDialog:function(){this.inherited(arguments);this._disableActionButton(true);if(this.dialogText&&typeof this.dialogText==="string"){_3.place("<p>"+this.dialogText+"</p>",this.dialogContent.domNode,"before");}this._dialog.own(this.dialogContent.on("change",this._onDialogContentChanged.bind(this)));},_onDialogContentChanged:function(_8){this._disableActionButton(!_8||!(_8.trim()));},_disableActionButton:function(_9){this._dialog.onActionPropertyChanged({name:this._dialog._okButtonName},"disabled",_9);},onDialogExecute:function(){this._executeDeferred.resolve(this._executeServiceMethod.call(this,this.dialogContent.value));},onDialogCancel:function(){this._executeDeferred.reject();},_executeServiceMethod:function(_a){return this.approvalService[this.executeMethod](this.approval.id,this.approval.activeStepIndex,_a).then(this._onContentStatusChange.bind(this));}});});