//>>built
require({cache:{"url:epi-cms/content-approval/templates/ApprovalComponent.html":"<div class=\"epi-content-approval\">\r\n    <div class=\"epi-localToolbar epi-viewHeaderContainer\" data-dojo-type=\"dijit/Toolbar\">\r\n        <div class=\"epi-toolbarGroupContainer\">\r\n            <div class=\"epi-toolbarGroup epi-toolbarLeading\">\r\n                <div data-dojo-attach-point=\"breadcrumb\" data-dojo-type=\"epi-cms/content-approval/Breadcrumb\" data-dojo-props=\"displayAsText:false, showCurrentNode:false\"></div>\r\n                <div data-dojo-attach-point=\"breadcrumbCurrentItem\" data-dojo-type=\"epi-cms/widget/BreadcrumbCurrentItem\"></div>\r\n            </div>\r\n            <div class=\"epi-toolbarGroup epi-toolbarTrailing\" data-dojo-attach-point=\"commandNode\">\r\n                <div data-dojo-attach-point=\"validation\" data-dojo-type=\"epi-cms/widget/NotificationStatusBar\"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"epi-content-approval__container\">\r\n        <div class=\"epi-content-approval__header\">\r\n            <hgroup class=\"epi-heading-group\">\r\n                <h1 class=\"epi-heading\"><span class=\"epi-heading-icon\" data-dojo-attach-point=\"contentIcon\"></span> <span data-dojo-attach-point=\"contentName\"></span></h1>\r\n                <h2 class=\"epi-heading\">${resources.title}</h2>\r\n            </hgroup>\r\n            <p>${resources.instructions.reviewers}</p>\r\n            <p>${resources.instructions.steps}</p>\r\n            <div class=\"epi-content-approval__settings clearfix\" data-dojo-type=\"dijit/form/Form\" data-dojo-attach-point=\"form\">\r\n                <span class=\"dijitInline\">\r\n                    <input id=\"enable-approval\" data-dojo-attach-point=\"enableButton\" data-dojo-type=\"dijit/form/RadioButton\" data-dojo-props=\"name:'status', value:${ApprovalDefinitionStatus.enabled}\">\r\n                    <label class=\"dijitInline\" for=\"enable-approval\">${resources.states.enabled}</label>\r\n                </span>\r\n                <span class=\"dijitInline\">\r\n                    <input id=\"inherit-approval\" data-dojo-attach-point=\"inheritButton\" data-dojo-type=\"dijit/form/RadioButton\" data-dojo-props=\"name:'status', value:${ApprovalDefinitionStatus.inherited}\">\r\n                    <label class=\"dijitInline\" for=\"inherit-approval\">${resources.states.inherited}</label>\r\n                </span>\r\n                <span class=\"dijitInline\">\r\n                    <input id=\"disabled-approval\" data-dojo-attach-point=\"disableButton\" data-dojo-type=\"dijit/form/RadioButton\" data-dojo-props=\"name:'status', value:${ApprovalDefinitionStatus.disabled}\">\r\n                    <label class=\"dijitInline\" for=\"disabled-approval\">${resources.states.disabled}</label>\r\n                </span>\r\n                <fieldset class=\"dijitInline\" data-dojo-attach-point=\"demandCommentFieldsetNode\">\r\n                    <div>\r\n                        <input id=\"demandcomment-start\" data-dojo-attach-point=\"demandStartCommentButton\" data-dojo-type=\"dijit/form/CheckBox\">\r\n                        <label class=\"dijitInline\" for=\"demandcomment-start\">${resources.demandcomment.start}</label>\r\n                    </div>\r\n                    <div>\r\n                        <input id=\"demandcomment-approve-approval\" data-dojo-attach-point=\"demandApproveCommentButton\" data-dojo-type=\"dijit/form/CheckBox\">\r\n                        <label class=\"dijitInline\" for=\"demandcomment-approve-approval\">${resources.demandcomment.label} ${resources.demandcomment.approve}</label>\r\n                    </div>\r\n                    <div>\r\n                        <input id=\"demandcomment-approval\" data-dojo-attach-point=\"demandDeclineCommentButton\" data-dojo-type=\"dijit/form/CheckBox\">\r\n                        <label class=\"dijitInline\" for=\"demandcomment-approval\">${resources.demandcomment.label} ${resources.demandcomment.decline}</label>\r\n                    </div>\r\n                    <div>\r\n                        <input id=\"prevent-self-approve\" data-dojo-attach-point=\"preventSelfApproveButton\" data-dojo-type=\"dijit/form/CheckBox\">\r\n                        <label class=\"dijitInline\" for=\"prevent-self-approve\">${resources.preventselfapprove}</label>\r\n                    </div>\r\n                </fieldset>\r\n            </div>\r\n        </div>\r\n        <div class=\"epi-content-approval__disabled-warning\" data-dojo-attach-point=\"warningNode\">\r\n            <span data-dojo-attach-point=\"warningMessage\"></span><a class=\"epi-visibleLink\" data-dojo-attach-point=\"goToInheritedSequence\" data-dojo-attach-event=\"onclick:_goToInheritedSequence\">${resources.gotoinheritedsequence}</a>\r\n        </div>\r\n        <div class=\"epi-content-approval__filter\" data-dojo-attach-point=\"filterNode\">\r\n            <span class=\"dijitInline\">${resources.languagefilter.description}</span>\r\n            <div data-dojo-attach-point=\"languageFilter\" data-dojo-type=\"dijit/form/Select\" class=\"epi-chromeless epi-chromeless--with-arrow epi-visibleLink\"></div>\r\n        </div>\r\n        <div data-dojo-attach-point=\"stepList\" data-dojo-type=\"epi-cms/content-approval/ApprovalStepList\"></div>\r\n    </div>\r\n</div>\r\n"}});define("epi-cms/content-approval/ApprovalComponent",["dojo/_base/lang","dojo/_base/declare","dojo/Deferred","dojo/dom-class","epi/shell/DialogService","epi/shell/command/builder/ButtonBuilder","epi-cms/content-approval/ApprovalEnums","epi-cms/content-approval/viewmodels/ContentApprovalViewModel","dijit/layout/_LayoutWidget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","epi/shell/widget/_ModelBindingMixin","dojo/text!./templates/ApprovalComponent.html","epi/i18n!epi/nls/episerver.cms.contentapproval.component","epi/i18n!epi/nls/episerver.shared.action","dijit/Toolbar","dijit/form/CheckBox","dijit/form/RadioButton","dijit/form/Select","dijit/form/Form","./Breadcrumb","epi-cms/widget/BreadcrumbCurrentItem","epi-cms/widget/NotificationStatusBar","epi-cms/content-approval/ApprovalStepList"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){function _10(_11,_12){_4.toggle(_11,"dijitHidden",!_12);};return _2([_9,_a,_b,_c],{templateString:_d,languageWarningTemplate:" <span class='dijitInline dijitReset dijitIcon epi-iconWarning' title='"+_e.languagefilter.warningmessage+"'></span>",resources:_e,ApprovalDefinitionStatus:_7.definitionStatus,_iconThumbnailTemplate:"<img class=\"epi-heading-icon-thumbnail\" src=\"{url}\" />",_iconContentTemplate:"<span class=\"dijitInline dijitReset dijitIcon epi-icon--large {iconClass} \"></span>",modelBindingMap:{approvalLink:["approvalLink"],content:["content"],isOptionsEnabled:["isOptionsEnabled"],isDeclineCommentRequired:["isDeclineCommentRequired"],isApproveCommentRequired:["isApproveCommentRequired"],isStartCommentRequired:["isStartCommentRequired"],selfApprove:["selfApprove"],isReadOnly:["isReadOnly"],filterOptions:["filterOptions"],status:["status"],approvalInheritedFrom:["approvalInheritedFrom"]},postMixInProperties:function(){this.inherited(arguments);this.model=this.model||new _8();this.own(this.model);},buildRendering:function(){this.inherited(arguments);var _13=new _6(),_14=this.model.get("commands");_14.forEach(function(_15){_13.create(_15,this.commandNode);},this);},postCreate:function(){this.inherited(arguments);this.stepList.set("model",this.model);this.own(this.enableButton.on("click",this._updateStatus.bind(this,_7.definitionStatus.enabled)),this.disableButton.on("click",this._updateStatus.bind(this,_7.definitionStatus.disabled)),this.inheritButton.on("click",this._updateStatus.bind(this,_7.definitionStatus.inherited)),this.demandDeclineCommentButton.on("click",this._updateDemandDeclineComment.bind(this)),this.demandApproveCommentButton.on("click",this._updateDemandApproveComment.bind(this)),this.demandStartCommentButton.on("click",this._updateDemandStartComment.bind(this)),this.preventSelfApproveButton.on("click",this._updateSelfApprove.bind(this)),this.languageFilter.on("change",this._updateSelectedLanguage.bind(this)));},updateView:function(){this._focus();},_updateSelectedLanguage:function(_16){this.model.set("selectedLanguage",_16);},_setNotificationContext:function(_17){this.validation.set("notificationContext",{contextTypeName:"epi.cms.approval",contextId:_17});},_setBreadcrumb:function(_18){this.breadcrumb.set("contentLink",_18.contentLink);this.breadcrumbCurrentItem.set("currentItemInfo",{name:_18.name,dataType:_18.typeIdentifier});},_setContentIcon:function(_19){_10(this.contentIcon,true);if(_19){this.contentIcon.innerHTML=_1.replace(this._iconThumbnailTemplate,{url:_19});return;}var _1a=this.model.iconClass();if(_1a){this.contentIcon.innerHTML=_1.replace(this._iconContentTemplate,{iconClass:_1a});return;}_10(this.contentIcon,false);},_setContentName:function(_1b){this.contentName.textContent=_1b;},_setApprovalLinkAttr:function(_1c){this._set("approvalLink",_1c);this._setNotificationContext(_1c);},_setContentAttr:function(_1d){this._set("content",_1d);if(!_1d){return;}this._setBreadcrumb(_1d);this._setContentName(_1d.name);this._setContentIcon(_1d.thumbnailUrl);},_setStatusAttr:function(_1e){this._set("status",_1e);this.form.set("value",{status:_1e});this._focus();_10(this.demandCommentFieldsetNode,(this.model.get("isEnabled")));_10(this.stepList.domNode,this.model.get("isEnabled"));_10(this.filterNode,this.model.get("isEnabled")&&!!this.model.get("filterOptions"));this._updateWarningMessage();},_focus:function(){this.enableButton.get("checked")&&this.enableButton.focus();this.disableButton.get("checked")&&this.disableButton.focus();this.inheritButton.get("checked")&&this.inheritButton.focus();},_setApprovalInheritedFromAttr:function(_1f){this._set("approvalInheritedFrom",_1f);this._updateWarningMessage();},_updateWarningMessage:function(){_10(this.warningNode,(!this.model.get("isEnabled")||this.model.get("isInherited")));_10(this.goToInheritedSequence,this.model.get("isInherited"));this.warningMessage.textContent=this.model.getWarningMessage();},_setIsDeclineCommentRequiredAttr:function(_20){this._set("isDeclineCommentRequired",_20);this.demandDeclineCommentButton.set("checked",_20);},_setIsApproveCommentRequiredAttr:function(_21){this._set("isApproveCommentRequired",_21);this.demandApproveCommentButton.set("checked",_21);},_setIsStartCommentRequiredAttr:function(_22){this._set("isStartCommentRequired",_22);this.demandStartCommentButton.set("checked",_22);},_setSelfApproveAttr:function(_23){this._set("selfApprove",_23);this.preventSelfApproveButton.set("checked",!_23);},_setIsOptionsEnabledAttr:function(_24){this._set("isOptionsEnabled",_24);this.demandDeclineCommentButton.set("disabled",!_24);this.demandApproveCommentButton.set("disabled",!_24);this.demandStartCommentButton.set("disabled",!_24);this.preventSelfApproveButton.set("disabled",!_24);},_setIsReadOnlyAttr:function(_25){this._set("isReadOnly",_25);this.enableButton.set("disabled",_25);this.disableButton.set("disabled",_25);this.inheritButton.set("disabled",_25);},_setFilterOptionsAttr:function(_26){this._set("filterOptions",_26);var _27=!!_26&&this.model.get("isEnabled");_10(this.filterNode,_27);if(!_26){return;}_26=_1.clone(_26);var _28=this.model.get("selectedLanguage")||"";_26.forEach(function(_29){if(!_29.isValid&&this.model.get("showValidations")){_29.label+=this.languageWarningTemplate;}_29.selected=_28===_29.value;},this);this.languageFilter.set("options",_26);this.languageFilter.set("value",_28);},_goToInheritedSequence:function(){this.model.goToInheritedSequence();},_updateStatus:function(_2a){var _2b;switch(_2a){case _7.definitionStatus.inherited:_2b=this._confirmInherit();break;case _7.definitionStatus.enabled:this.model.enable();_2b=new _3().resolve();break;case _7.definitionStatus.disabled:_2b=this._confirmDisable();break;}_2b.otherwise(this.set.bind(this,"status",this.status));},_updateDemandDeclineComment:function(e){var _2c=e.target.checked;this.model.set("isDeclineCommentRequired",_2c);this.demandDeclineCommentButton.set("checked",_2c);},_updateDemandApproveComment:function(e){var _2d=e.target.checked;this.model.set("isApproveCommentRequired",_2d);this.demandApproveCommentButton.set("checked",_2d);},_updateDemandStartComment:function(e){var _2e=e.target.checked;this.model.set("isStartCommentRequired",_2e);this.demandStartCommentButton.set("checked",_2e);},_updateSelfApprove:function(e){var _2f=e.target.checked;this.model.set("selfApprove",!_2f);this.preventSelfApproveButton.set("checked",_2f);},_confirmDisable:function(){var _30={title:this.resources.disable.title,description:this.resources.disable.description,confirmActionText:_f.disable,cancelActionText:_f.cancel};return _5.confirmation(_30).then(this.model.disable.bind(this.model));},_confirmInherit:function(){var _31={title:this.resources.inherit.title,description:this.resources.inherit.description,confirmActionText:this.resources.inherit.okbutton,cancelActionText:_f.cancel,setFocusOnConfirmButton:false};return _5.confirmation(_31).then(this.model.inheritDefinition.bind(this.model));}});});