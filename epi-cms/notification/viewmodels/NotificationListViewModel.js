//>>built
define("epi-cms/notification/viewmodels/NotificationListViewModel",["dojo/_base/declare","dojo/Evented","dojo/Stateful","dojo/topic","dojo/when","dijit/Destroyable","epi/dependency"],function(_1,_2,_3,_4,_5,_6,_7){return _1([_3,_2,_6],{store:null,service:null,query:null,queryOptions:null,selectedNotification:null,postscript:function(){this.inherited(arguments);this.queryOptions=this.queryOptions||{sort:[{attribute:"posted",descending:true},{attribute:"id",descending:true}]};this.store=this.store||_7.resolve("epi.storeregistry").get("epi.cms.notification");this.service=this.service||_7.resolve("epi.cms.NotificationService");this.query=this.query||{};},initialize:function(){return _5(null);},readSelectedNotification:function(){this.markSelectedNotificationAsRead();this.gotoSelectedNotificationOrigin();},gotoSelectedNotificationOrigin:function(){if(!this.selectedNotification||!this.selectedNotification.link||this.selectedNotification.isExternal){return;}var _8=this.selectedNotification.link;_4.publish("/epi/shell/context/request",{uri:_8},{sender:this,forceReload:true});},markSelectedNotificationAsRead:function(){if(!this.selectedNotification){return;}this.service.markAsRead(this.selectedNotification.id).then(this.set.bind(this,"selectedNotification"));},markAllAsRead:function(){this.service.markAllAsRead();}});});